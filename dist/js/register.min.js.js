"use strict";document.addEventListener("DOMContentLoaded",function(){autoCar("../"),$(".nav_y").on("click",function(){location.href="list.html"}),$("h1").on("click",function(){location.href="../index.html"});var o=document.querySelector("#phoneTxt"),s=document.querySelector("#phoneMes"),i=!1,e=document.querySelector("#registerBtn");o.onclick=function(){"请输入手机号"==o.value&&(o.value="")},o.onblur=function(){var e=o.value,n=checkReg.trim(e);if(""==n)s.innerHTML="",s.style.color="";else if(n&&checkReg.tel(n)){var t=new XMLHttpRequest,l="../api/reg_select.php?phone="+e+"&time="+new Date;t.open("GET",l,!0),t.send(),t.onreadystatechange=function(){4!=t.readyState||200!=t.status&&304!=t.status||("0"==t.responseText?(s.innerHTML='该手机号已被使用，可直接<a href="../html/login.html" style="text-decoration:underline">登录</a>！',s.style.display="block",o.previousElementSibling.className="no"):(s.innerHTML="",o.previousElementSibling.className="yes",i=!0))}}else s.innerHTML="手机号码格式不正确，请重新输入！",s.style.display="block",o.previousElementSibling.className="no"};var n=document.getElementById("codeTxt"),t=document.querySelector("#codeMes"),c=!1;n.onclick=function(){"请输入验证码"==n.value&&(n.value="")};var l=new GVerify("codeBtn");n.onblur=function(){l.validate(n.value)?(t.innerHTML="",c=!0):(t.innerHTML="您输入的验证码有误，请重新输入！",t.style.display="block")};document.querySelector(".chizi");var a=document.querySelector(".fugai"),r=(document.querySelector(".pullX"),!1);0!=a.offsetLeft&&(a.onmousedown=function(e){var e=e||window.event,t=e.clientX-a.offsetLeft;e.preventDefault(),document.onmousemove=function(e){var e=e||window.event,n=e.clientX-t;0<=n&&(n=0,a.onmousedown=null),a.style.left=n+"px"}},r=document.onmouseup=function(e){var e=e||window.event;if(e.preventDefault(),document.onmousemove=null,0!=a.offsetLeft)a.style.left="-246px";else{a.innerHTML='验证通过！<span class="pullStop"></span>';var n=a.lastElementChild}return"pullStop"==n.className?(r=!0,console.log(r)):r=!1,r});var u=document.getElementById("pswTxt"),m=document.querySelector("#pswMes"),d=!1;u.onblur=function(){var e=u.value,n=checkReg.trim(e);""==n?m.innerHTML="":n==o.value?(m.innerHTML="密码不能与手机号码一样",m.style.display="block",u.previousElementSibling.className="no"):n&&checkReg.psweasy(n)?(m.innerHTML="",u.previousElementSibling.className="yes",d=!0):(m.innerHTML="密码须为6-16位字母,数字,半角符号中至少两种组合",m.style.display="block",u.previousElementSibling.className="no")};var p=document.getElementById("psw2Txt"),v=document.querySelector("#psw2Mes"),y=!1;p.onblur=function(){p.value;""==p.value?v.innerHTML="":p.value==u.value?(p.previousElementSibling.className="yes",v.innerHTML="",y=!0):(v.innerHTML="两次输入的密码不一致!",v.style.display="block",p.previousElementSibling.className="no")};var f=document.getElementById("check_agree"),g=document.getElementById("xieyiMes"),h=!1;f.onclick=function(){1==f.checked?(h=!0,e.className=""):(h=!1,e.className="no")},e.onclick=function(){if(h){var e=o.value.trim(),n=u.value.trim();if(i&&r&&c&&d&&y){var t=new XMLHttpRequest;t.open("POST","../api/reg_insert.php",!0),t.setRequestHeader("content-type","application/x-www-form-urlencoded");var l="phone="+e+"&psw="+n;t.send(l),t.onreadystatechange=function(){if(4==t.readyState&&(200==t.status||304==t.status)){var e=t.responseText;console.log(e),"yes"==e?location.href="../html/login.html":alert("注册失败")}}}else alert("注册失败")}else g.style.display="blcok"}});