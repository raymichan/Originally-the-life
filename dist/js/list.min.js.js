"use strict";$(function(){autoCar("../"),$(".nav_y").on("click",function(){location.href="list.html"}),$("h1").on("click",function(){location.href="../index.html"});var t=document.querySelector(".list_ku"),n=document.querySelector("#page"),i=document.querySelector("#prev"),l=document.querySelector("#next"),c=0,o="way=asc&key=goodsid";function r(a){t.innerHTML="";var e=a.datalist.map(function(a){return'<li data-id="'+a.goodsid+'">\n                            <div class="box">\n                                <p class="jump pic"><img src="'+a.imgurl1+'"/></p>\n                                <p class="jump name">\n                                    <a href="javascript:;">'+a.name+"</a>\n                                    <span>"+a.title+'</span>\n                                </p>\n                                <p class="price">￥'+a.cutprice+"<span>￥"+a.oldprice+'</span></p>\n                                <p class="qty">\n                                    <a href="javascript:;" class="jian"></a>\n                                    <input type="text" value="1" class="addCarNum"/>\n                                    <a href="javascript:;"javascript:; class="jia"></a>\n                                </p>\n                                <p class="btn"><img src="../images/listAddCar.gif"/></p>\n                            </div>\n                        </li>'}).join("");t.innerHTML=e}var d=new XMLHttpRequest,e="../api/list_select.php?page=1&qty=16&time=new Date()";d.open("GET",e,!0),d.send(),d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var a=d.responseText,e=JSON.parse(a);console.log(e),r(e);var t=Math.ceil(e.total/e.qty);c=t;for(var s=0;s<t;s++)n.innerHTML+="<span>"+(s+1)+"</span>";n.children[0].className="active",2<=t&&(i.style.display="block",l.style.display="block")}};var s,p=1;n.onclick=function(a){"span"==(a=a||window.event).target.tagName.toLowerCase()&&(p=a.target.innerText,e="../api/list_select.php?page="+p+"&qty=16&time=new Date()&"+o,d.open("GET",e,!0),d.send(),d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var a=d.responseText;r(JSON.parse(a));for(var e=0;e<n.children.length;e++)n.children[e].className="";n.children[p-1].className="active",clearTimeout(s),s=setTimeout(function(){window.scrollTo(0,0)},1e3)}})},i.onclick=function(){--p<=1&&(p=1);var a="../api/list_select.php?page="+p+"&qty=16&time=new Date()&"+o;d.open("GET",a,!0),d.send(),d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var a=d.responseText;r(JSON.parse(a));for(var e=0;e<n.children.length;e++)n.children[e].className="";n.children[p-1].className="active",clearTimeout(s),s=setTimeout(function(){window.scrollTo(0,0),console.log(111)},1e3)}}},l.onclick=function(){c<=++p&&(p=c);var a="../api/list_select.php?page="+p+"&qty=16&time=new Date()&"+o;d.open("GET",a,!0),d.send(),d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var a=d.responseText;r(JSON.parse(a));for(var e=0;e<n.children.length;e++)n.children[e].className="";n.children[p-1].className="active",clearTimeout(s),s=setTimeout(function(){window.scrollTo(0,0)},1e3)}}};var u=!0,m=!0,h=!0,v=!0;$(".list_sort").on("click","li",function(){var a,e,t,s;$(".list_sort li a").removeClass("on"),$(".list_sort li span").removeClass("up"),$(".list_sort li span").removeClass("down"),$(this).is(".default")?(a="asc",e="goodsid"):$(this).is(".times")?($(".times a").addClass("on"),e="timer",a=u?($(".times span").addClass("up"),"asc"):($(".times span").addClass("down"),"desc"),u=!u):$(this).is(".sellqty")?($(".sellqty a").addClass("on"),e="sellqty",a=m?($(".sellqty span").addClass("up"),"asc"):($(".sellqty span").addClass("down"),"desc"),m=!m):$(this).is(".price")?($(".price a").addClass("on"),e="cutprice",a=h?($(".price span").addClass("up"),"asc"):($(".price span").addClass("down"),"desc"),h=!h):$(this).is(".comment")&&($(".comment a").addClass("on"),e="sellqty",a=v?($(".comment span").addClass("up"),"asc"):($(".comment span").addClass("down"),"desc"),v=!v),t=a,s=e,$.ajax({type:"GET",url:"../api/list_select.php?page=1&qty=16&way="+t+"&key="+s+"&time=new Date()",success:function(a){var e=JSON.parse(a);console.log(e),r(e)}}),o="way="+a+"&key="+e}),$(".list_ku").on("click",".jian",function(){var a=$(this).next().val();--a<=1&&(a=1),$(this).next().val(a)}),$(".list_ku").on("click",".jia",function(){var a=$(this).prev().val();100<=++a&&(a=100),$(this).prev().val(a)}),$(".list_ku").on("click",".btn",function(){console.log("btn");var a=Cookie.get("uname"),e=$(this).parent().parent().data("id"),s=$(this).parent().find(".addCarNum").val();$.ajax({type:"POST",url:"../api/car.php",data:"admin="+a+"&goodsid="+e+"&addqty="+s,success:function(a){var e=JSON.parse(a);console.log(a),console.log(e),console.log(e.adminlist),console.log(Array.isArray(e.adminlist));var t=0;e.adminlist?e.adminlist.map(function(a){t+=Number(a.qty)}):t=0,creatAddMycar(e,"../"),creatAddCarSide(e,s,t)}})}),$(".list_ku ").on("click",".pic",function(){var a=$(this).parent().parent().data("id");location.href="detail.html?goodsid="+a}),$(".list_ku ").on("click",".name",function(){var a=$(this).parent().parent().data("id");location.href="detail.html?goodsid="+a})});